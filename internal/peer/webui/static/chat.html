<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>P2P Mesh Chat</title>
    <!-- Login page still relies on styles.css; the app surface loads the richer theme sheet. -->
    <link rel="stylesheet" href="/static/app.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body data-theme="dark">
    <!--
      AppLayout wraps the entire SPA surface. Each region (nav, chat, drawers) is
      annotated with an id to allow the JS modules to attach renderers.
    -->
    <div class="app-layout">
      <!-- Side navigation: workspaces, quick nav, theme toggles -->
      <aside class="side-nav" aria-label="Workspace navigation">
        <div class="logo">P2P Chat</div>
        <nav class="nav-section">
          <button class="nav-item" data-panel="chat">ğŸ’¬ Chat</button>
          <button class="nav-item" data-panel="files">ğŸ“ Files</button>
          <button class="nav-item" data-panel="settings">âš™ï¸ Settings</button>
        </nav>
        <div class="nav-footer">
          <button id="theme-toggle" class="nav-item">ğŸŒ™ Toggle theme</button>
          <button id="logout-btn" class="nav-item danger">â» Logout</button>
        </div>
      </aside>

      <!-- Main content column -->
      <main class="content">
        <header class="top-bar">
          <div class="identity">
            <span class="label">Logged in as</span>
            <strong id="me-name">-</strong>
          </div>
          <div class="presence" id="presence"></div>
          <button id="notifications-toggle" class="pill">ğŸ”” Notifications</button>
        </header>

        <!-- Primary work area uses tabs but defaults to chat -->
        <section id="panel-chat" class="panel is-active">
          <div class="chat-header">
            <div class="command-bar" id="command-buttons"></div>
            <input id="target" class="dm-field" placeholder="DM target (optional)" />
          </div>
          <section id="messages" class="message-list" aria-live="polite"></section>
          <form id="composer" class="composer" autocomplete="off">
            <button type="button" id="emoji-btn" class="ghost" aria-label="Insert emoji">ğŸ˜Š</button>
            <textarea id="input" rows="2" placeholder="Type a message or /command"></textarea>
            <label class="file-btn">
              ğŸ“
              <input id="file-input" type="file" hidden />
            </label>
            <button type="submit" class="primary">Send</button>
          </form>
          <div id="emoji-panel" class="emoji-panel" hidden></div>
        </section>

        <section id="panel-files" class="panel" aria-hidden="true">
          <header class="panel-header">
            <h2>File Transfers</h2>
            <div>
              <button class="pill" data-filter="uploads">Uploads</button>
              <button class="pill" data-filter="downloads">Downloads</button>
            </div>
          </header>
          <div id="file-list" class="file-list"></div>
        </section>

        <section id="panel-settings" class="panel" aria-hidden="true">
          <header class="panel-header">
            <h2>Settings</h2>
          </header>
          <div class="settings-grid" id="settings-grid"></div>
        </section>
      </main>

      <!-- Notifications drawer slides in from the right -->
      <aside id="notifications" class="notifications" aria-live="polite" aria-label="Notifications panel">
        <div class="notifications-header">
          <h2>Notifications</h2>
          <button id="notifications-close" aria-label="Close">âœ–</button>
        </div>
        <div id="notifications-list" class="notifications-list"></div>
      </aside>
    </div>

    <!-- Entry module bootstraps state, transport, and UI layers. -->
    <script type="module" src="/static/app.js"></script>
  </body>
</html>
